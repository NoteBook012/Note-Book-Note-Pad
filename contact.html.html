<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <title>Contact Us - Note Pad - Modern Online Notepad, Whiteboard & To-Do List</title>
    
    <meta name="description" content="Contact Note Pad for support, feedback, or inquiries. Get in touch with Bishal Mishra, the developer."/>
    
    <meta name="keywords" content="contact, contact us, support, feedback, Note Pad, bishal mishra"/>
    
    <meta name="author" content="Bishal Mishra">
    <meta name="robots" content="index, follow">

    <link rel="canonical" href="https://bishalmishra.com/contact.html">

    <meta property="og:title" content="Contact Us - Note Pad - Modern Online Notepad, Whiteboard & To-Do List" />
    <meta property="og:description" content="Contact Note Pad for support, feedback, or inquiries." />
    <meta property="og:image" content="https://i.imgur.com/kR1k1jU.png" />
    <meta property="og:url" content="https://bishalmishra.com/contact.html" />
    <meta property="og:type" content="website" />
    
    <meta name="msvalidate.01" content="F28FD042305E7D060B4355FA59E662D8" />
    <link rel="manifest" href="manifest.json">
        
    <meta name="yandex-verification" content="af349c5874d738ed" />
   
    <link rel="icon" type="image/png" href="images/favicon.png"> 

    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <!-- AdSense SCRIPT (typically in HEAD) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3010913100191778"
         crossorigin="anonymous"></script>
    <!-- End AdSense SCRIPT -->
   
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Inter:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- intl-tel-input CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.13/css/intlTelInput.min.css" />
    
    <!-- Google reCAPTCHA API SCRIPT -->
    <!-- This script MUST be included for reCAPTCHA to work -->
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>

    <style>
        :root {
            --bg-light: linear-gradient(120deg, #fdfbfb 0%, #ebedee 100%);
            --text-light: #333;
            --card-light: #ffffff;
            --shadow-light: rgba(0, 0, 0, 0.08);

            --bg-dark: linear-gradient(120deg, #2b2b2b 0%, #1e1e1e 100%);
            --text-dark: #e0e0e0;
            --card-dark: #2c2c2c;
            --shadow-dark: rgba(0, 0, 0, 0.25);
           
            --primary: #8c53ff;
            --primary-dark: #7042cc;
            --primary-light-transparent: rgba(140, 83, 255, 0.1);
            --radius: 12px;
            --input-border-green: #90ee90; /* Light Green */
            --input-bg-green: #f0fff0; /* Very light green */
        }

        html { height: 100%; scroll-behavior: smooth; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg-light); color: var(--text-light); line-height: 1.6; transition: background 0.5s ease, color 0.5s ease; display: flex; flex-direction: column; min-height: 100vh; }
        body.dark { background: var(--bg-dark); color: var(--text-dark); }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        main.container { width: 95%; max-width: 1200px; margin: 20px auto; flex-grow: 1; padding-bottom: 40px; } 
        header, footer { background: var(--primary); color: white; padding: 15px 5%; text-align: center; box-shadow: 0 4px 15px var(--shadow-light); z-index: 10; }
        header {
            display: flex;
            justify-content: flex-start; /* Default for mobile */
            align-items: center;
            position: relative;
        }
        .header-content {
            text-align: center;
            flex-grow: 1; /* Allows it to take center space */
        }
        body.dark header, body.dark footer { box-shadow: 0 4px 15px var(--shadow-dark); }
        footer { margin-top: auto; padding: 20px;  }
        footer a { color: #fff; font-weight: 600; text-decoration: none; transition: opacity 0.2s; margin: 0 10px;  }
        footer a:hover { opacity: 0.8; text-decoration: underline; }
        footer p { margin-bottom: 10px; } 
        
        .sidenav {
            height: 100%;
            width: 0; 
            position: fixed;
            z-index: 1002; 
            top: 0;
            left: 0;
            overflow-x: hidden;
            transition: 0.5s;
            padding-top: 60px;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
        }

        body.dark .sidenav {
            background-color: rgba(30, 30, 30, 0.95);
        }

        .sidenav a {
            padding: 10px 15px 10px 32px;
            text-decoration: none;
            font-size: 20px; 
            font-weight: 600;
            color: var(--text-light);
            display: block;
            transition: 0.3s;
        }
        body.dark .sidenav a {
            color: var(--text-dark);
        }

        .sidenav a:hover {
            color: var(--primary);
        }

        .sidenav .closebtn {
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }

        .open-nav-btn {
            font-size: 28px;
            cursor: pointer;
            color: white;
            transition: transform 0.2s;
            position: absolute;
            left: 5%;
            top: 50%;
            transform: translateY(-50%);
        }
        .open-nav-btn:hover {
            transform: translateY(-50%) scale(1.1);
        }

        /* Hide app-specific and blog section elements on static pages */
        #menu-bar, #editor, #notes, #whiteboard-container, #calendar-container, 
        #blogs-section, #faq-section, #premium-features-section, 
        #overview, #how-it-works, #about { 
            display: none; 
        }

        .info-section, #privacy-policy-section, #terms-of-service-section, #disclaimer-section, #contact-us-section
        { 
            background: var(--card-light); 
            padding: 25px; 
            border-radius: var(--radius); 
            box-shadow: 0 4px 15px var(--shadow-light); 
            margin-bottom: 25px; 
            text-align: left; /* Changed from original center */
        }
        body.dark .info-section, body.dark #privacy-policy-section, body.dark #terms-of-service-section, body.dark #disclaimer-section, body.dark #contact-us-section { 
            background: var(--card-dark); 
            box-shadow: 0 4px 15px var(--shadow-dark); 
        }
       
        h2, h3 { font-size: 24px; margin-bottom: 20px; color: var(--primary); /* text-align: center; */ } /* Removed center align */
        .info-section h3 { text-align: left;  } /* Adjusted to prevent override from other specific headers */
        .info-section p, .info-section ul, 
        #privacy-policy-section p, #privacy-policy-section ul, 
        #terms-of-service-section p, #terms-of-service-section ul, 
        #disclaimer-section p, #disclaimer-section ul  { 
            margin-bottom: 15px; 
        }
        .info-section ul { list-style: none; padding-left: 0; }
        .info-section ul li { padding-left: 30px; position: relative; margin-bottom: 12px; }
        .info-section ul li::before { content: '\f058'; font-family: 'Font Awesome 6 Free'; font-weight: 900; color: var(--primary); position: absolute; left: 0; top: 2px; font-size: 18px; }
        #privacy-policy-section h4, #terms-of-service-section h4, #disclaimer-section h4 { font-size: 1.2em; color: var(--primary-dark); margin-top: 20px; margin-bottom: 10px; }

        /* Contact Us Styling */
        #contact-us-section { background: var(--card-light); padding: 25px; border-radius: var(--radius); box-shadow: 0 4px 15px var(--shadow-light); margin-bottom: 25px; }
        body.dark #contact-us-section { background: var(--card-dark); box-shadow: 0 4px 15px var(--shadow-dark); }
        #contact-us-section > h2 { text-align: left; margin-bottom: 20px; color: var(--text-light); font-size: 32px; } /* Main H2 for the section */
        body.dark #contact-us-section > h2 { color: var(--text-dark); }


        #contact-us-section .contact-info { /* New class for the existing contact list */
            margin-top: 30px; /* Space between form and existing info */
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        body.dark #contact-us-section .contact-info {
            border-top-color: #444;
        }
        #contact-us-section .contact-info h2 { /* New h2 for the details section */
            font-size: 24px;
            color: var(--primary);
            text-align: center;
            margin-bottom: 20px;
        }

        #contact-us-section .contact-info ul { list-style: none; padding: 0; margin-top: 15px; }
        #contact-us-section .contact-info li { display: flex; align-items: center; margin-bottom: 15px; font-size: 16px; }
        #contact-us-section .contact-info li svg { width: 24px; height: 24px; margin-right: 12px; fill: var(--primary); }
        #contact-us-section .contact-info li a { color: var(--primary); text-decoration: none; font-weight: 500; }
        #contact-us-section .contact-info li a:hover { text-decoration: underline; color: var(--primary-dark); }
        #contact-us-section .contact-info li span { color: var(--text-light); }
        body.dark #contact-us-section .contact-info li span { color: var(--text-dark); }

        /* Get In Touch Form Specific Styling */
        .get-in-touch-form h2 {
            font-size: 32px;
            color: var(--text-light); /* Black color from image */
            margin-bottom: 8px;
        }
        body.dark .get-in-touch-form h2 {
            color: var(--text-dark);
        }
        .get-in-touch-form p {
            color: #777; /* Grey color from image */
            margin-bottom: 25px;
            font-size: 18px;
            font-weight: 400;
        }
        body.dark .get-in-touch-form p {
            color: #bbb;
        }

        .form-group {
            margin-bottom: 15px;
        }

        input[type="text"],
        input[type="email"],
        textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid var(--input-border-green);
            border-radius: var(--radius);
            background-color: var(--input-bg-green);
            font-size: 16px;
            color: var(--text-light);
            transition: border-color 0.3s, box-shadow 0.3s, background-color 0.3s;
            outline: none;
            font-family: 'Poppins', sans-serif;
        }
        body.dark input[type="text"],
        body.dark input[type="email"],
        body.dark textarea {
            background-color: #3a3a3a; /* Darker background for inputs */
            border-color: #555; /* Darker border */
            color: var(--text-dark);
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light-transparent);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* intl-tel-input specific styles */
        .iti {
            width: 100%; /* Ensure the input takes full width */
            margin-bottom: 0px; /* Adjust spacing */
        }
        .iti__flag-container {
            padding: 0; /* Remove default padding */
        }
        /* Style for the dropdown button (flag and dial code) */
        .iti__selected-flag {
            padding-left: 15px; /* Adjust padding for flag */
            background-color: var(--input-bg-green); /* Match input background */
            border-right: 1px solid var(--input-border-green); /* Separator */
            border-radius: var(--radius) 0 0 var(--radius); /* Rounded left corners */
            height: 100%; /* Fill height */
            /* Ensure the flag and dial code are visible */
            display: flex !important; /* Force flex display */
            align-items: center; /* Center vertically */
            justify-content: center; /* Center horizontally if space allows */
        }
        body.dark .iti__selected-flag {
            background-color: #3a3a3a;
            border-right-color: #555;
        }
        .iti__selected-flag:hover {
            background-color: rgba(144, 238, 144, 0.7); /* Lighter green on hover */
        }
        body.dark .iti__selected-flag:hover {
            background-color: #4a4a4a;
        }
        /* Style for the dropdown list of countries */
        .iti__country-list {
            border: 1px solid var(--input-border-green);
            box-shadow: 0 4px 15px var(--shadow-light);
            border-radius: var(--radius);
            background-color: var(--card-light);
            font-family: 'Poppins', sans-serif;
            z-index: 100; /* Ensure it appears above other elements */
        }
        body.dark .iti__country-list {
            border-color: #555;
            box-shadow: 0 4px 15px var(--shadow-dark);
            background-color: var(--card-dark);
        }
        /* Styling for the dial code number */
        .iti__dial-code {
            color: var(--text-light);
            margin-left: 8px; /* Space between flag and dial code */
        }
        body.dark .iti__dial-code {
            color: var(--text-dark);
        }
        /* Search input within the dropdown */
        .iti__search-input {
            width: calc(100% - 20px) !important; /* Adjust search input width */
            border: 1px solid var(--input-border-green);
            background-color: var(--input-bg-green);
            color: var(--text-light);
            margin: 10px;
            padding: 8px 10px;
            border-radius: 8px;
        }
        body.dark .iti__search-input {
            background-color: #3a3a3a;
            border-color: #555;
            color: var(--text-dark);
        }
        /* Individual country items in the list */
        .iti__country {
            padding: 10px 15px;
            color: var(--text-light);
        }
        body.dark .iti__country {
            color: var(--text-dark);
        }
        /* Highlighted country in the list (on hover/focus) */
        .iti__country.highlight {
            background-color: var(--primary-light-transparent);
        }
        .iti__country.highlight .iti__dial-code,
        .iti__country.highlight .iti__country-name {
            color: var(--primary);
        }


        /* Styles for the reCAPTCHA error message */
        #recaptcha-error {
            color: #dc3545; /* Red color for error */
            margin-top: 5px; 
            font-size: 14px;
        }

        button[type="submit"] {
            background-color: #4CAF50; /* A shade of green */
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: var(--radius);
            font-size: 18px;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-block; /* To allow auto margins if needed */
            margin-top: 10px;
            font-weight: 600;
        }

        button[type="submit"]:hover {
            background-color: #45a049; /* Darker green on hover */
            transform: translateY(-2px);
        }
        
        /* Style for disabled submit button */
        button[type="submit"]:disabled {
            background-color: #a0a0a0; /* Grey out disabled button */
            cursor: not-allowed;
            transform: none; /* No hover effect when disabled */
        }

        /* Google Maps Styling */
        .google-maps {
            margin-top: 30px;
            border-top: 1px solid #eee;
            padding-top: 20px;
            text-align: center;
        }
        body.dark .google-maps {
            border-top-color: #444;
        }
        .google-maps h2 {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 20px;
        }
        .google-maps iframe {
            width: 100%;
            height: 400px;
            border: 0;
            border-radius: var(--radius);
            box-shadow: 0 4px 15px var(--shadow-light);
        }
        body.dark .google-maps iframe {
            box-shadow: 0 4px 15px var(--shadow-dark);
        }


        /* AdSense Container Style (Hidden on static pages unless specified otherwise) */
        .adsense-ad-container { 
            margin: 25px auto; padding: 10px 0; text-align: center; min-height: 50px; 
            background-color: var(--card-light); border-radius: var(--radius); 
            box-shadow: 0 2px 8px var(--shadow-light); 
            display: none; /* Explicitly hidden on static pages */
        }
        body.dark .adsense-ad-container { background-color: var(--card-dark); box-shadow: 0 2px 8px var(--shadow-dark); }
        
        .hidden { display: none !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        .profile-container {
            position: relative;
            z-index: 999;
            margin-left: auto; /* Push to the right in flex container */
        }
        #profile-icon {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: transform 0.2s ease-in-out;
            object-fit: cover;
        }
        #profile-icon:hover, #profile-icon:focus { transform: scale(1.1); }
        .profile-dropdown {
            position: absolute;
            top: 55px; 
            right: 0; 
            width: 260px;
            background: var(--card-light);
            border-radius: var(--radius);
            box-shadow: 0 8px 25px var(--shadow-light);
            border: 1px solid #eee;
            overflow: hidden;
            animation: fadeIn 0.3s ease;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        body.dark .profile-dropdown { background: var(--card-dark); box-shadow: 0 8px 25px var(--shadow-dark); border-color: #444; }
        .dropdown-header { display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid #f0f0f0; }
        body.dark .dropdown-header { border-bottom-color: #444; }
        .dropdown-header img { width: 48px; height: 48px; border-radius: 50%; object-fit: cover; }
        .dropdown-header span { font-weight: 600; font-size: 16px; word-break: break-all; }
        body.dark .dropdown-header small { color: #bbb !important; }
        .dropdown-menu { list-style: none; padding: 10px 0; margin: 0; }
        .dropdown-menu li a { display: flex; align-items: center; gap: 12px; padding: 12px 20px; text-decoration: none; color: var(--text-light); font-size: 14px; transition: background-color 0.2s ease; }
        body.dark .dropdown-menu li a { color: var(--text-dark); }
        .dropdown-menu li a:hover { background-color: #f5f5f5; }
        body.dark .dropdown-menu li a:hover { background-color: #3e3e3e; }
        .dropdown-menu li.divider { height: 1px; margin: 8px 0; background: #e0e0e0; }
        body.dark .dropdown-menu li.divider { background: #444; }
        #emailVerifiedStatus .fa-check-circle { color: #28a745; } 
        #emailVerifiedStatus .fa-times-circle { color: #dc3545; } 
        
        .modal, .welcome-popup { display: none; } /* Explicitly hide popups/modals */
        #find-replace-dialog { display: none; } /* Explicitly hide find/replace */
        
        #goToTopBtn { position: fixed; bottom: 20px; right: 20px; width: 50px; height: 50px; background-color: var(--primary); color: white; border: none; border-radius: 50%; font-size: 24px; cursor: pointer; display: none; z-index: 1000; box-shadow: 0 4px 12px var(--shadow-light); transition: all 0.3s ease-in-out; display: flex; align-items: center; justify-content: center; } 
        #goToTopBtn:hover { background-color: var(--primary-dark); transform: scale(1.1); } 
        body.dark #goToTopBtn { box-shadow: 0 4px 12px var(--shadow-dark); } 
        
        .confetti { font-size: 48px; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); animation: pop 1s ease-out; pointer-events: none; z-index: 2000; display: none !important; } 
        @keyframes pop { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0; } 60% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }

        /* --- MEDIA QUERIES --- */
        
        /* Desktop Layout */
        @media (min-width: 1024px) {
            header {
                justify-content: space-between;
                padding-left: 5%;
                padding-right: 5%;
            }
            .header-content {
                flex-grow: 0; /* Don't grow to push profile icon */
                margin: 0 auto; /* Center title */
            }
            .open-nav-btn {
                position: relative; /* Take it out of absolute positioning */
                left: auto;
                top: auto;
                transform: none;
            }
            .profile-container {
                position: relative; /* Take it out of fixed positioning */
                top: auto;
                right: auto;
                margin-left: 20px; /* Space from nav button */
            }
        }

        /* Tablet and smaller devices */
        @media (max-width: 768px) { 
            .sidenav a { font-size: 18px; }
            h2, h3 { font-size: 20px; }
            .get-in-touch-form h2 { font-size: 28px; }
            .get-in-touch-form p { font-size: 16px; }
            input[type="text"], input[type="email"], textarea, .iti__selected-flag, .iti__search-input {
                font-size: 14px;
            }
            button[type="submit"] {
                font-size: 16px;
                padding: 10px 20px;
            }
            .google-maps iframe {
                height: 300px;
            }
        }
        
        /* Mobile phones */
        @media (max-width: 480px) {
            .profile-container {
                position: fixed; /* Keep it fixed on small mobile */
                top: 10px;
                right: 10px;
            }
            .get-in-touch-form h2 { font-size: 24px; }
            .get-in-touch-form p { font-size: 14px; }
            input[type="text"], input[type="email"], textarea, .iti__selected-flag, .iti__search-input {
                padding: 10px 12px;
            }
            .google-maps iframe {
                height: 250px;
            }
        }
    </style>
</head>
<body>

<div id="mySidenav" class="sidenav">
  <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">√ó</a>
  <a href="index.html" onclick="closeNavAndGoTo('index.html')">Home</a>
  <a href="index.html#overview" onclick="closeNavAndGoTo('index.html#overview')">Overview</a>
  <a href="about.html" onclick="closeNavAndGoTo('about.html')">About</a>
  <a href="blogs.html" onclick="closeNavAndGoTo('blogs.html')">Blog</a>
  <a href="index.html#faq-section" onclick="closeNavAndGoTo('index.html#faq-section')">FAQ</a>
  <a href="privacy-policy.html" onclick="closeNavAndGoTo('privacy-policy.html')">Privacy Policy</a>
  <a href="terms-of-service.html" onclick="closeNavAndGoTo('terms-of-service.html')">Terms of Service</a>
  <a href="disclaimer.html" onclick="closeNavAndGoTo('disclaimer.html')">Disclaimer</a>
  <a href="contact.html" onclick="closeNavAndGoTo('contact.html')">Contact</a>
</div>

<header>
    <span class="open-nav-btn" onclick="openNav()">‚ò∞</span>
    <div class="header-content">
        <h1>
            <a href="index.html" style="text-decoration: none; color: inherit;">
                üìù NOTE_<span style="color:#ffc107">P@D</span>
            </a>
        </h1>
        <p style="margin-top: 5px; font-weight: 300; opacity: 0.9;">Notepad, Whiteboard, and To-Do List</p>
    </div>
    <div id="profile-container" class="profile-container hidden">
        <img id="profile-icon" src="https://ui-avatars.com/api/?name=U" alt="Profile" tabindex="0" width="42" height="42">
        <div id="profile-dropdown" class="profile-dropdown hidden">
            <div class="dropdown-header">
                <img id="userPic" src="https://ui-avatars.com/api/?name=U&background=random&color=fff" alt="Profile" width="48" height="48"> 
                <div>
                    <span id="userNameDisplay">User Name</span>
                    <small id="userEmailDisplay" style="color: #888; display: block; font-weight: 400;"></small>
                </div>
            </div>
            <ul class="dropdown-menu">
                <li><a href="#" id="editProfilePhotoBtn"><i class="fas fa-camera fa-fw"></i> Edit Profile Photo</a></li>
                <li><a href="#" id="verifyEmailBtn"><i class="fas fa-envelope fa-fw"></i> Verify Email <span id="emailVerifiedStatus"></span></a></li>
                <li><a href="#" id="resetPasswordBtn"><i class="fas fa-key fa-fw"></i> Reset Password</a></li>
                <li class="divider"></li>
                <li><a href="#" id="manageAccountBtn"><i class="fas fa-user-cog fa-fw"></i> Manage Account</a></li> 
                <li class="divider"></li>
                <li><a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt fa-fw"></i> Logout</a></li>
            </ul>
        </div>
    </div>
</header>
<input type="file" id="photoUpload" class="hidden" accept="image/*">

<main id="main-container" class="container">
    <div id="contact-us-section" class="info-section"> 
        <div class="get-in-touch-form">
            <h2>Get In Touch</h2>
            <p>We are Here For You. Can we Help ?</p>
            <form id="contactForm">
                <div class="form-group">
                    <input type="text" id="fullName" placeholder="Full Name *" required>
                </div>
                <div class="form-group">
                    <input type="email" id="email" placeholder="Email *" required>
                </div>
                <div class="form-group">
                    <!-- The intl-tel-input library will convert this input -->
                    <input type="text" id="phone" placeholder="Phone Number">
                </div>
                <div class="form-group">
                    <input type="text" id="subject" placeholder="Subject *" required>
                </div>
                <div class="form-group">
                    <textarea id="message" placeholder="Message *" required></textarea>
                </div>
                
                <!-- START GOOGLE RECAPTCHA V2 INTEGRATION -->
                <div class="form-group">
                    <!-- This is the DIV where the "I'm not a robot" checkbox will appear -->
                    <div id="recaptcha-widget" class="g-recaptcha"
                         data-sitekey="6LeeSHQrAAAAALPfJynl9NFBeCpqcFiiMLLoJ4v_"
                         <!-- This is your reCAPTCHA v2 "I'm not a robot" site key. -->
                         <!-- NOTE: For reCAPTCHA to work correctly, this page MUST be served from a web server (e.g., http://localhost) -->
                         <!-- and NOT opened directly from the file system (e.g., file:///C:/...). -->
                         <!-- Also, the site key must be registered for the domain you are using. -->
                        
                         data-callback="onRecaptchaSuccess"
                         data-expired-callback="onRecaptchaExpired">
                    </div>
                    <div id="recaptcha-error"></div> <!-- This will display reCAPTCHA-related errors -->
                </div>
                <!-- END GOOGLE RECAPTCHA V2 INTEGRATION -->

                <!-- The submit button is initially disabled and will be enabled by JavaScript AFTER reCAPTCHA is completed -->
                <button type="submit" id="submitButton" disabled>Submit</button>
            </form>
        </div>

        <div class="google-maps">
            <h2>Find Us On Map</h2>
            <iframe 
                src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d14131.066497334707!2d85.25997258931113!3d27.69176318465135!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x39eb18129031d2e1%3A0xc3c51ed1c37b75f!2sKirtipur%20Kathmandu%2044618!5e0!3m2!1sen!2snp!4v1717398123456!5m2!1sen!2snp" 
                allowfullscreen="" 
                loading="lazy" 
                referrerpolicy="no-referrer-when-downgrade"
                title="Google Maps Location of Kirtipur, Kathmandu">
            </iframe>
        </div>

        <div class="contact-info">
            <h2>Our Contact Details</h2>
            <ul>
                <li>
                    <svg viewBox="0 0 24 24"><path d="M20,15.5C18.83,15.5 17.67,15.33 16.56,15C16.3,14.92 16,15 15.82,15.21L13.21,17.83C10.38,16.39 7.61,13.62 6.17,10.79L8.79,8.17C9,8 9.08,7.7 9,7.44C8.67,6.33 8.5,5.17 8.5,4A1.5,1.5 0 0,0 7,2.5H4A1.5,1.5 0 0,0 2.5,4C2.5,13.39 10.61,21.5 20,21.5A1.5,1.5 0 0,0 21.5,20V17A1.5,1.5 0 0,0 20,15.5Z" /></svg>
                    <span>+977 9827801575, +977 9828138995</span>
                </li>
                <li>
                    <svg viewBox="0 0 32 32"><path d="M16.001 2.667c-7.364 0-13.334 5.969-13.334 13.333 0 2.354.622 4.655 1.802 6.667l-1.864 5.401 5.569-1.813c1.937 1.061 4.119 1.619 6.463 1.619h.002c7.365 0 13.334-5.97 13.334-13.334 0-3.555-1.383-6.899-3.896-9.413s-5.858-3.46-9.276-3.46zM16 26.667c-1.984 0-3.938-.519-5.657-1.5l-.404-.231-3.292 1.073 1.096-3.176-.256-.417c-1.063-1.732-1.624-3.729-1.624-5.719 0-6.065 4.935-11 11-11 2.938 0 5.7 1.146 7.775 3.221 2.073 2.073 3.225 4.835 3.225 7.779 0 6.066-4.935 11-11 11zm6.219-7.865c-.338-.169-2.004-.988-2.316-1.102s-.537-.169-.763.17- .876 1.102-1.075 1.33c-.198.225-.394.254-.732.085-.339-.17-1.431-.528-2.723-1.684-1.007-.9-1.687-2.008-1.885-2.347-.198-.34-.021-.522.149-.69.152-.151.34-.394.509-.592.169-.199.225-.339.339-.564.113-.226.056-.423-.028-.593-.084-.17-.763-1.84-1.046-2.516-.276-.661-.558-.572-.763-.582l-.65-.012c-.198 0-.52.074-.791.339s-1.04 1.016-1.04 2.48 1.065 2.875 1.213 3.075c.149.198 2.097 3.2 5.083 4.487.711.306 1.264.489 1.696.626.713.227 1.36.195 1.871.119.571-.085 1.744-.712 1.99-1.4.247-.688.247-1.28.172-1.4-.07-.113-.308-.18-.646-.34z"/></svg>
                    <a href="https://wa.me/9779827801575" target="_blank" rel="noopener noreferrer">WhatsApp (+977 9827801575)</a>
                </li>
                <li>
                    <svg viewBox="0 0 24 24"><path d="M12 13.065L1.5 6.75V18a1.5 1.5 0 001.5 1.5h18a1.5 1.5 0 001.5-1.5V6.75l-10.5 6.315zM21 4.5H3a1.5 1.5 0 00-1.2.6l10.2 6.135L22.2 5.1A1.5 1.5 0 0021 4.5z"/></svg>
                    <a href="mailto:bishalmishra9000@gmail.com">bishalmishra9000@gmail.com</a>
                </li>
                <li>
                    <svg viewBox="0 0 24 24"><path d="M22.675 0H1.325C.593 0 0 .593 0 1.326V22.67c0 .733.593 1.326 1.325 1.326h11.495V14.7h-3.13v-3.622h3.13V8.41c0-3.1 1.893-4.788 4.66-4.788 1.325 0 2.464.099 2.796.143v3.24h-1.918c-1.504 0-1.796.716-1.796 1.766v2.316h3.59l-.467 3.622h-3.123V24h6.116c.73 0 1.323-.593 1.323-1.326V1.326C24 .593 23.406 0 22.675 0z"/></svg>
                    <a href="https://www.facebook.com/share/19LTBhKXuy/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">Facebook Page</a>
                </li>
                <li>
                    <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12c0 4.67 3.26 8.56 7.6 9.74.56.1.77-.24.77-.53v-1.87c-3.1.67-3.75-1.49-3.75-1.49-.5-1.29-1.21-1.63-1.21-1.63-.99-.68.07-.67.07-.67 1.1.08 1.68 1.12 1.68 1.12.97 1.66 2.54 1.18 3.16.9.1-.7.38-1.18.69-1.45-2.47-.28-5.06-1.23-5.06-5.5 0-1.22.43-2.21 1.14-3-.12-.28-.49-1.41.11-2.94 0 0 .93-.3 3.05 1.15.88-.24 1.83-.36 2.77-.36.94 0 1.89.12 2.77.36 2.12-1.45 3.05-1.15 3.05-1.15.6 1.53.23 2.66.11 2.94.71.79 1.14 1.78 1.14 3 0 4.28-2.6 5.22-5.07 5.5.39.34.73 1.01.73 2.03v3c0 .29.21.63.78.52A10.004 10.004 0 0022 12c0-5.52-4.48-10-10-10z"/></svg>
                    <a href="https://bishalmishra.com" target="_blank" rel="noopener noreferrer">www.bishalmishra.com</a> 
                </li>
            </ul>
        </div>
    </div>
</main>

<!-- Auth Modal (Globally present but hidden by default for non-app pages) -->
<div id="authModal" class="modal hidden"> 
    <div class="modal-content"> 
        <h2 id="authTitle">Sign In to Note P@d</h2> 
        <input type="text" id="authUsername" placeholder="Username (Email)" autocomplete="username"/> 
        <input type="password" id="authPassword" placeholder="Password" autocomplete="current-password"/> 
        <button id="authSubmit">Sign In</button> 
        <div id="googleSignInDiv" style="margin: 20px auto 0; display: flex; justify-content: center;"></div> 
        <a href="#" id="forgotPassword">Forgot Password?</a> 
        <p id="switchMode">Don't have an account? <a href="#">Sign Up</a></p> 
    </div> 
</div>
<button id="goToTopBtn" title="Go to top" aria-label="Go to top">‚Üë</button>
<div id="confetti" class="confetti hidden">üéâ</div>
<audio id="loginSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>

<footer>
   <p>Copyright ¬© <span id="currentYear"></span> <a href="https://www.facebook.com/share/166miohhL6/?mibextid=wwXIfr" target="_blank" rel="noopener noreferrer">Bishal Mishra</a> | All Rights Reserved.</p>
   <div>
        <a href="privacy-policy.html">Privacy Policy</a> |
        <a href="terms-of-service.html">Terms of Service</a> |
        <a href="disclaimer.html">Disclaimer</a> |
        <a href="contact.html">Contact Us</a>
   </div>
</footer>

<!-- intl-tel-input JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.13/js/intlTelInput.min.js"></script>

<script>
// --- GLOBAL VARIABLES (minimal set for this static page) ---
let isSignUp = false;

// New global variable to store the reCAPTCHA token
let recaptchaToken = null;

const goToTopBtn = document.getElementById('goToTopBtn');
const authModal = document.getElementById('authModal');
const authTitle = document.getElementById('authTitle');
const authUsername = document.getElementById('authUsername');
const authPassword = document.getElementById('authPassword');
const authSubmit = document.getElementById('authSubmit');
const switchAuthModeLink = document.getElementById('switchMode');
const confetti = document.getElementById('confetti');
const loginSound = document.getElementById('loginSound');

const profileContainer = document.getElementById('profile-container');
const profileIcon = document.getElementById('profile-icon');
const profileDropdown = document.getElementById('profile-dropdown');
const userPic = document.getElementById('userPic');
const userNameDisplay = document.getElementById('userNameDisplay');
const userEmailDisplay = document.getElementById('userEmailDisplay');
const emailVerifiedStatus = document.getElementById('emailVerifiedStatus');
const logoutBtn = document.getElementById('logoutBtn');
const verifyEmailBtn = document.getElementById('verifyEmailBtn');
const resetPasswordBtn = document.getElementById('resetPasswordBtn');
const editProfilePhotoBtn = document.getElementById('editProfilePhotoBtn');
const photoUploadInput = document.getElementById('photoUpload');
const manageAccountBtn = document.getElementById('manageAccountBtn'); 

// Get references to your submit button and the reCAPTCHA error message div
const submitButton = document.getElementById('submitButton'); 
const recaptchaErrorDiv = document.getElementById('recaptcha-error');

// --- SIDENAV & NAVIGATION FUNCTIONS ---
function openNav() { document.getElementById("mySidenav").style.width = "280px"; }
function closeNav() { document.getElementById("mySidenav").style.width = "0"; }
function closeNavAndGoTo(url) { closeNav(); setTimeout(() => window.location.href = url, 300); }

// --- GOOGLE RECAPTCHA CALLBACK FUNCTIONS ---
// These functions are called by Google reCAPTCHA when the checkbox is interacted with.
function onRecaptchaSuccess(token) {
    recaptchaToken = token; // Store the reCAPTCHA token
    submitButton.disabled = false; // Enable the submit button as reCAPTCHA is completed
    recaptchaErrorDiv.textContent = ''; // Clear any previous error message
    console.log('reCAPTCHA successful, token received:', token);
}

function onRecaptchaExpired() {
    recaptchaToken = null; // Clear the token if it expires
    submitButton.disabled = true; // Disable the submit button again
    recaptchaErrorDiv.textContent = 'reCAPTCHA expired. Please re-verify.';
    console.warn('reCAPTCHA expired.');
    // You might also want to explicitly reset the reCAPTCHA widget here
    if (typeof grecaptcha !== 'undefined' && grecaptcha.reset) {
        grecaptcha.reset();
    }
}

// --- EVENT LISTENERS ---
document.addEventListener("DOMContentLoaded", () => {
    loadDarkMode();
    checkAuthStatus(); 
    attachEventListeners();
    document.getElementById('currentYear').textContent = new Date().getFullYear();

    // Initialize intl-tel-input
    const phoneInputField = document.querySelector("#phone");
    if (phoneInputField) {
        window.iti = intlTelInput(phoneInputField, {
            initialCountry: "np", // Set initial country to Nepal (NP for Nepal)
            preferredCountries: ["np", "in", "us", "gb", "ca"], // Prefer Nepal, India, US, UK, Canada
            utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.13/js/utils.js", // Required for formatting/validation
        });

        if (!phoneInputField.closest('.iti')) {
            console.error("intl-tel-input failed to initialize on the #phone input.");
            console.error("This often happens when running directly from the file system (file:///...).");
            console.error("Please run the page using a local web server (e.g., http://localhost:8000) for full functionality.");
        } else {
            console.log("intl-tel-input initialized successfully.");
        }
    }

    // Handle contact form submission
    const contactForm = document.getElementById('contactForm');
    if (contactForm) {
        contactForm.addEventListener('submit', function(event) { // Keep as non-async for simplicity in this "easiest" version
            event.preventDefault(); // Prevent default form submission

            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const subject = document.getElementById('subject').value.trim();
            const message = document.getElementById('message').value.trim();
            let phone = '';
            if (window.iti && phoneInputField) { 
                phone = window.iti.getNumber(); 
            }
            
            // --- CHECK RECAPTCHA TOKEN ON CLIENT-SIDE ---
            if (!recaptchaToken) {
                recaptchaErrorDiv.textContent = 'Please complete the reCAPTCHA.';
                alert('Please complete the reCAPTCHA before submitting.');
                return;
            }
            recaptchaErrorDiv.textContent = ''; // Clear error if reCAPTCHA is completed

            if (!fullName || !email || !subject || !message) {
                alert('Please fill in all required fields (marked with *)');
                return;
            }

            if (!validateEmail(email)) {
                alert('Please enter a valid email address.');
                return;
            }

            if (window.iti && !window.iti.isValidNumber()) { 
                alert('Please enter a valid phone number.');
                return;
            }
            
            // ********************************************************************************
            // *** IMPORTANT SECURITY WARNING FOR "100% WORKING" RECAPTCHA ***
            // ********************************************************************************
            // The following `alert` simulates success. In a real application, you would:
            // 1. Send the form data AND `recaptchaToken` to YOUR SERVER using `fetch`.
            // 2. On your server, you would make a POST request to Google's reCAPTCHA API (https://www.google.com/recaptcha/api/siteverify)
            //    using your PRIVATE SECRET KEY (NEVER expose this key in client-side code).
            // 3. Your server would check if Google's response indicates successful verification.
            // 4. ONLY IF THE SERVER VERIFICATION IS SUCCESSFUL, then your server would proceed
            //    to send the email or save the data.
            // 5. Your server would send a success/failure response back to THIS client-side code.
            // ********************************************************************************
            // FOR THIS DEMO, WE ARE SKIPPING THE SERVER-SIDE VERIFICATION FOR SIMPLICITY.
            // THIS IS NOT SECURE FOR PRODUCTION USE.
            // ********************************************************************************

            alert('Your message has been sent successfully! (NOTE: reCAPTCHA was only verified client-side in this demo. For real security, you NEED a server-side verification step.)');
            
            // Clear form fields
            contactForm.reset();
            if (window.iti) { 
                window.iti.setNumber(""); 
            }
            
            // Reset reCAPTCHA after submission (whether simulated or real)
            // This prepares the widget for another submission
            if (typeof grecaptcha !== 'undefined' && grecaptcha.reset) {
                grecaptcha.reset(); 
            }
            recaptchaToken = null; // Clear the stored token
            submitButton.disabled = true; // Disable button until reCAPTCHA is re-completed

            // If you later decide to use a backend, you'd re-introduce a fetch call here.
            // For now, this is the "easiest" way to see it "work" without a backend.
        });
    }
});

window.onload = function() {
    // Only initialize Google Sign-In if the elements related to it exist and if the library is loaded.
    if (document.getElementById('googleSignInDiv')) {
        if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
            initGoogleSignIn();
        } else {
            let attempts = 0;
            const intervalId = setInterval(() => {
                attempts++;
                if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
                    initGoogleSignIn();
                    clearInterval(intervalId);
                } else if (attempts > 20) {
                    console.error("Google Sign-In did not initialize in time.");
                    if(document.getElementById('googleSignInDiv')) {
                         document.getElementById('googleSignInDiv').innerHTML = "Google Sign-In failed to load. Please try refreshing.";
                    }
                    clearInterval(intervalId);
                }
            }, 500);
        }
    }
};

function attachEventListeners() {
    // Go-to-top button
    window.onscroll = () => { 
        if (goToTopBtn) goToTopBtn.style.display = (document.body.scrollTop > 200 || document.documentElement.scrollTop > 200) ? "flex" : "none"; 
    };
    if (goToTopBtn) goToTopBtn.onclick = () => window.scrollTo({ top: 0, behavior: 'smooth' });
    
    // Profile Dropdown functionality
    if (profileIcon) profileIcon.addEventListener('click', toggleProfileDropdown);
    document.addEventListener('click', closeDropdownOnClickOutside);
    
    // Auth-related button handlers (these functions exist but won't be triggered by UI on this page)
    if (logoutBtn) logoutBtn.addEventListener('click', handleLogout);
    if (verifyEmailBtn) verifyEmailBtn.addEventListener('click', handleVerifyEmail);
    if (resetPasswordBtn) resetPasswordBtn.addEventListener('click', handleResetPassword);
    if (manageAccountBtn) manageAccountBtn.addEventListener('click', handleManageAccount); 
    if (editProfilePhotoBtn) editProfilePhotoBtn.addEventListener('click', (e) => { 
        e.preventDefault(); 
        if(photoUploadInput) photoUploadInput.click();
    });
    if (photoUploadInput) photoUploadInput.addEventListener('change', handlePhotoUpload);

    // Auth modal specific handlers (these are for the modal itself, which is hidden)
    if (authSubmit) authSubmit.onclick = handleAuthSubmit;
    if (switchAuthModeLink) switchAuthModeLink.onclick = (e) => { 
        e.preventDefault(); 
        isSignUp = !isSignUp; 
        if(authTitle) authTitle.textContent = isSignUp ? "Create your Account" : "Welcome Back"; 
        if(authSubmit) authSubmit.textContent = isSignUp ? "Sign Up" : "Sign In"; 
        switchAuthModeLink.innerHTML = isSignUp ? 'Already have an account? <a href="#">Sign In</a>' : 'Don‚Äôt have an account? <a href="#">Sign Up</a>'; 
    };
}

// --- PROFILE & AUTHENTICATION FUNCTIONS (shared logic) ---
function toggleProfileDropdown() { if(profileDropdown) profileDropdown.classList.toggle('hidden'); }
function closeDropdownOnClickOutside(event) { 
    if (profileContainer && !profileContainer.contains(event.target) && 
        profileDropdown && !profileDropdown.classList.contains('hidden')) {
        profileDropdown.classList.add('hidden');
    }
    // Also close authModal if open and clicked outside (though it should be hidden by default on static pages)
    if (authModal && !authModal.contains(event.target) && !authModal.classList.contains('hidden')) {
        authModal.classList.add('hidden');
    }
}

function checkAuthStatus() {
    const currentUserId = localStorage.getItem('currentUserId'); // Fixed to use localStorage directly
    if (currentUserId) {
        showUserInfo();
    } else {
        if(profileContainer) profileContainer.classList.add('hidden');
    }
}

function showUserInfo() {
    const username = localStorage.getItem('currentUser');
    const picUrl = localStorage.getItem('userPic');
    const email = localStorage.getItem('userEmail');
    const isVerified = localStorage.getItem('emailVerified') === 'true';

    if (!username || !profileContainer) return;

    profileContainer.classList.remove('hidden');
    
    const avatarUrl = picUrl || `https://ui-avatars.com/api/?name=${encodeURIComponent(username.substring(0,2))}&background=random&color=fff&size=48`;
    if(profileIcon) profileIcon.src = avatarUrl;
    if(userPic) userPic.src = avatarUrl;
    if(userNameDisplay) userNameDisplay.textContent = username;
    if(userEmailDisplay) userEmailDisplay.textContent = email || '';

    if (emailVerifiedStatus) {
        if (isVerified) {
            emailVerifiedStatus.innerHTML = '<i class="fas fa-check-circle" title="Email is verified"></i>';
            if(verifyEmailBtn) { verifyEmailBtn.style.opacity = '0.6'; verifyEmailBtn.style.cursor = 'default'; }
        } else {
            emailVerifiedStatus.innerHTML = '<i class="fas fa-times-circle" title="Email not verified"></i>';
            if(verifyEmailBtn) { verifyEmailBtn.style.opacity = '1'; verifyEmailBtn.style.cursor = 'pointer'; }
        }
    }
    
    if(verifyEmailBtn && verifyEmailBtn.parentElement) verifyEmailBtn.parentElement.style.display = 'block';

    const provider = localStorage.getItem('authProvider');
    if (resetPasswordBtn && resetPasswordBtn.parentElement) {
        if (provider === 'google') {
            resetPasswordBtn.parentElement.style.display = 'none';
            if (isVerified && verifyEmailBtn && verifyEmailBtn.parentElement) {
                verifyEmailBtn.parentElement.style.display = 'none';
            }
        } else {
            resetPasswordBtn.parentElement.style.display = 'block';
        }
    }
}

function handleAuthSubmit() {
    // This function is present because it's part of the common auth script.
    // On static pages, the auth modal should typically not be visible unless manually triggered.
    if(!authUsername || !authPassword) return;
    const username = authUsername.value.trim();
    const password = authPassword.value.trim();
    if (!username || !password) { alert("Please fill in all fields"); return; }
    const users = JSON.parse(localStorage.getItem("users") || "{}");
    if (isSignUp) {
        if (users[username]) { alert("Username (email) already exists."); return; }
        users[username] = password; 
        localStorage.setItem("users", JSON.stringify(users));
        localStorage.setItem('authProvider', 'email');
        localStorage.setItem('userEmail', username);
        localStorage.setItem('emailVerified', 'false');
        localStorage.setItem("currentUser", username);
        loginSuccess(username, "", username);
    } else {
        if (!users[username] || users[username] !== password) { alert("Invalid credentials"); return; }
        if (localStorage.getItem('userEmail') !== username) localStorage.setItem('userEmail', username);
        if (localStorage.getItem('authProvider') !== 'email') localStorage.setItem('authProvider', 'email');
        if (localStorage.getItem('emailVerified') === null) localStorage.setItem('emailVerified', 'false');
        localStorage.setItem("currentUser", username);
        loginSuccess(username, "", username);
    }
}

function handleLogout(e) {
    if(e) e.preventDefault();
    localStorage.removeItem("currentUser");
    localStorage.removeItem("userPic");
    localStorage.removeItem("currentUserId");
    localStorage.removeItem("emailVerified");
    localStorage.removeItem("userEmail");
    localStorage.removeItem("authProvider");
    
    if (typeof google !== 'undefined' && google.accounts && google.accounts.id) {
        google.accounts.id.disableAutoSelect();
    }
    
    if(profileContainer) profileContainer.classList.add('hidden');
    if(profileDropdown && !profileDropdown.classList.contains('hidden')) profileDropdown.classList.add('hidden');
    
    // If the auth modal happened to be open, ensure it's hidden after logout
    if(authModal) authModal.classList.add("hidden"); 
}

function handlePhotoUpload(event) {
    const file = event.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = (e) => {
        localStorage.setItem('userPic', e.target.result);
        showUserInfo(); 
        alert("Profile photo updated!");
    };
    reader.readAsDataURL(file);
}

function handleVerifyEmail(e) {
    e.preventDefault();
    if (localStorage.getItem('emailVerified') === 'true') { alert('Your email is already verified.'); return; }
    if (localStorage.getItem('authProvider') === 'google') { alert('Google accounts are typically pre-verified or managed via Google.'); return; }
    
    const verificationCode = Math.floor(100000 + Math.random() * 900000).toString();
    alert(`A verification code has been "sent" to your email (for demo purposes, it's shown here).\n\nYour code is: ${verificationCode}\n\nPlease enter this code in the prompt.`);
    const userCode = prompt("Please enter the 6-digit verification code:");
    if (userCode === verificationCode) { localStorage.setItem('emailVerified', 'true'); alert("Email verified successfully!"); showUserInfo(); } 
    else if (userCode) { alert("Incorrect code. Please try again."); } 
    else { alert("Verification cancelled."); }
}

function handleResetPassword(e) {
    e.preventDefault();
    if (localStorage.getItem('authProvider') === 'google') { alert("Password reset is managed through your Google account."); return; }
    if (!localStorage.getItem('currentUser')) { alert("Please sign in to reset your password."); return; }

    const newPassword = prompt("Enter your new password (min 4 characters):");
    if (!newPassword || newPassword.length < 4) { if (newPassword !== null) alert("Password is too short."); return; }

    const confirmPassword = prompt("Confirm your new password:");
    if (newPassword !== confirmPassword) { alert("Passwords do not match."); return; }

    const username = localStorage.getItem('userEmail');
    if(!username) { alert("User email not found. Cannot reset password."); return;}
    const users = JSON.parse(localStorage.getItem("users") || "{}");
    if (users[username]) { users[username] = newPassword; localStorage.setItem("users", JSON.stringify(users)); alert("Your password has been reset successfully!"); } 
    else { alert("An error occurred. Could not find user to update password."); }
}

function handleManageAccount(e) { e.preventDefault(); alert("You can manage your profile photo and email verification from the dropdown. For other account settings, please contact support if needed."); }

function loginSuccess(username, picUrl, userId) {
    localStorage.setItem("currentUserId", userId);
    if(picUrl) localStorage.setItem("userPic", picUrl);
    showUserInfo();
    if(authModal) authModal.classList.add("hidden"); // Ensure modal is hidden on successful login
    if(confetti) { confetti.classList.remove("hidden"); setTimeout(() => { confetti.classList.add("hidden"); }, 1200); }
    if(loginSound) loginSound.play().catch(e => console.warn("Audio play failed:", e));
}

function initGoogleSignIn() {
    try {
        if (!google || !google.accounts || !google.accounts.id) { console.error("Google Sign-In library not fully loaded."); return; }
        google.accounts.id.initialize({ client_id: "107788525119-7mkm9t2pqe53q85ltenn4lr3av7itdfh.apps.googleusercontent.com", callback: handleGoogleSignIn });
        const googleSignInButtonContainer = document.getElementById("googleSignInDiv");
        if (googleSignInButtonContainer) google.accounts.id.renderButton(googleSignInButtonContainer, { theme: "outline", size: "large", shape: "pill", width: "300" });
        else console.warn("Google Sign-In button container not found.");
    } catch (error) {
        console.error("Google GSI could not be initialized.", error);
        const googleSignInButtonContainer = document.getElementById('googleSignInDiv');
        if (googleSignInButtonContainer) googleSignInButtonContainer.innerHTML = "Google Sign-In failed to load.";
    }
}

function jwtDecode(token) { 
    try { 
        return JSON.parse(atob(token.split('.')[1])); 
    } catch (e) { 
        console.error("Failed to decode JWT", e); 
        return null; 
    } 
}

function handleGoogleSignIn(response) {
    const data = jwtDecode(response.credential);
    if (!data) { alert("Failed to process Google Sign-In. Please try again."); return;}
    const name = data.name || data.email;
    const picture = data.picture || "";
    const userId = data.sub;
    const email = data.email;
    const emailVerified = data.email_verified === true || data.email_verified === 'true';
    localStorage.setItem("currentUser", name);
    localStorage.setItem('authProvider', 'google');
    localStorage.setItem('userEmail', email);
    localStorage.setItem('emailVerified', emailVerified.toString());
    loginSuccess(name, picture, userId);
}

function getCurrentUserId() { return localStorage.getItem('currentUserId'); }

// --- DARK MODE ---
function loadDarkMode() { if (localStorage.getItem('darkMode') === 'true') document.body.classList.add('dark'); }
function toggleDark() { document.body.classList.toggle('dark'); localStorage.setItem('darkMode', document.body.classList.contains('dark')); }

// --- UTILITY (Password Hashing for local storage, only used by auth) ---
async function hashPassword(password) { 
    if (!password) return ''; 
    try {
        const encoder = new TextEncoder(); 
        const data = encoder.encode(password); 
        const hashBuffer = await crypto.subtle.digest('SHA-256', data); 
        const hashArray = Array.from(new Uint8Array(hashBuffer)); 
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    } catch(e) { 
        console.error("Password hashing failed", e); 
        return 'error_hashing_password'; 
    }
}

// Basic email validation
function validateEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(String(email).toLowerCase());
}
</script>
</body>
</html>